<!DOCTYPE html>
<html>
  <head>
    <title>Palestine Online</title>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="public/98.css" />
    <link rel="stylesheet" href="public/style.css" />
    <link rel="preconnect" href="https://web.archive.org">

    <link rel="preload" href="/images/bg-min.png" as="image">
    <link rel="preload" href="/images/bg-min.png" as="image">

    <link rel="preload" href="/public/tiles/keffiyeh-dithered.gif" as="image">
    <link rel="preload" href="/public/tiles/aqwa-man-tile-bg.jpg" as="image">
    <link rel="preload" href="/public/tiles/arabic-html-tutorial-tile-bg.jpg" as="image">
    <link rel="preload" href="/public/tiles/hadisoft-tile-bg.jpeg" as="image">
    <link rel="preload" href="/public/tiles/jukebox-arabia-tile-bg.gif" as="image">

    <link rel="preload" href="/public/tiles/lina-online-tile-bg.GIF" as="image">
    <link rel="preload" href="/public/tiles/nidal-jayyousi-tile-bg.jpg" as="image">
    <link rel="preload" href="/public/tiles/palestine-youth-union-tile-bg.jpg" as="image">
    <link rel="preload" href="/public/tiles/people-of-palestine-tile-bg.gif" as="image">
    <link rel="preload" href="/public/tiles/zuhair-tile-bg.gif" as="image">

    <link rel="preload" href="/public/tiles/rani-tile-bg.jpg" as="image">
    <link rel="preload" href="/public/tiles/samia-halaby-1-tile-bg.gif" as="image">
    <link rel="preload" href="/public/tiles/sharabati-tile-bg.JPG" as="image">
    <link rel="preload" href="/public/tiles/pals2.gif" as="image">
    <link rel="preload" href="/public/tiles/back.jpg" as="image">

    <link rel="preload" href="/public/tiles/back4.jpg" as="image">
    <link rel="preload" href="/public/tiles/hanthbg.gif" as="image">
    <link rel="preload" href="/public/tiles/cloudtil.jpg" as="image">
    <link rel="preload" href="/public/tiles/welcome.gif" as="image">
    <link rel="preload" href="/public/tiles/back.jpg" as="image">

    <script src="src/functions.js"></script>

  </head>

  <body onload="setFramePage()">
    <button class="mobile-share-alert">
      Page Link copied to clipboard.
    </button>
    <div id="mobile-dropdown-content" class="dropdown-content">
      <ul class="tree-view" id="tree"></ul>
    </div>
    <button class="mobile-top-nav">
      <div class="address-bar">
        <div id="address-bar-text">
          Samia Halaby's site
        </div>
      </div>
      <img class="mobile-nav-folder" src="public/directory_closed_cool-4.svg" onclick="dropdownContent.classList.toggle('open');" />
    </button>
    <div class="mobile-buttons-grid" id="mobile-nav">
      <button id="zoomSlider">
        <div class="field-row">
          <label id="mobile-zoom-out" class="slider-label">-</label>
          <input id="zoom-slider" step="any" onchange="changeZoom(this.value)" id="range26" type="range" min="1" max="21" value="11" />
          <label class="slider-label" id="mobile-zoom-in">+</label>
        </div>
      </button>
      <button class="mobile-button">
        <img class="mobile-button-graphic" src="public/back.svg" height="30px" onclick="historyNav(window, 'back')" />
      </button>
      <button class="mobile-button">
        <img class="mobile-button-graphic" src="public/front.svg" height="30px" onclick="historyNav(window, 'forward')" />
      </button>
      <button class="mobile-button">
        <img class="mobile-button-graphic" height="30px" src="public/icons/envelope_closed-1.svg" onclick="shareSite('mobile')"/>
      </button>
      <button class="mobile-button">
        <img class="mobile-button-graphic" height="30px" src="public/netmeeting-1.svg" onclick="setFramePage(true)" />
      </button>
      <button class="mobile-button">
        <img class="mobile-button-graphic" height="30px" src="public/icons/help_book_small-5.svg" onclick="setRandomPage()"/>
      </button>
    </div>
    <div class="window-grid" id="window">
      <div class="info-panel-container" id="info-panel-container" style="visibility: hidden">
        <div class="notes-header">Page Information</div>
        <div class="close-info-panel-button">
          <div class="title-bar-controls">
            <button class="notes-close-button" style="zoom: 1.4" aria-label="Close"></button>
          </div>
        </div>
      </div>
      <div class="window walkthru-window">
        <div class="title-bar">
          <div class="title-bar-text">
            Palestine Online
          </div>
        </div>
        <div class="window-body" style="margin: 0px; overflow: hidden;">
          <section style="margin: 6px 8px 4px 8px" class="field-row" style="justify-content: flex-start">
            <a class="tooltip">
              <input type="image" onclick="historyNav(window, 'back')" src="public/back.svg" height="24px"
                style="margin-bottom: 2px" />
              <span class="tooltiptext">Go Back</span>
            </a>
            <a class="tooltip">
              <input type="image" onclick="historyNav(window, 'forward')" src="public/front.svg" height="24px"
                style="margin-bottom: 2px" />
              <span class="tooltiptext">Go Forward</span>
            </a>
            <div class="divider">|</div>
            <!-- <a class="tooltip">
              <input style="opacity: 1; cursor: pointer" type="image" src="public/home.svg" height="25px" onclick="" />
              <span class="tooltiptext">Go to Homepage</span>
            </a> -->
            <a class="tooltip">
              <input type="image" src="public/icons/help_book_small-5.svg" height="25px" onclick="setRandomPage()" />
              <span class="tooltiptext">Go to random site</span>
            </a>
            <a class="tooltip">
              <input style="opacity: 1; cursor: pointer" type="image" src="public/netmeeting-1.svg" height="25px" onclick="setFramePage(true)" />
              <span class="tooltiptext">Reset current site</span>
            </a>
            <a class="tooltip">
              <input type="image" onclick="shareSite()" src="public/icons/envelope_closed-1.svg" height="25px" />
              <span id="share-page-tooltip" class="tooltiptext">Share Page</span>
            </a>
            <a class="tooltip">
              <!-- (empty tooltip for spacing) -->
            </a>
            <div class="dropdown-container">
              <pre id="current-site">
                </pre>
              <a class="tooltip">
                <div class="dropdown">
                </div>
                <span class="tooltiptext tooltip-address-bar">View websites</span>
              </a>
              <div id="dropdown-content" class="dropdown-content">
                <ul class="tree-view" id="tree-original"></ul>
              </div>
            </div>
            <a class="tooltip">
              <input type="image" onclick="showInformation()" src="public/icons/info.svg" height="25px" />
              <span class="tooltiptext tooltip-right">About Palestine Online</span>
            </a>
          </section>
          <iframe id="menu" title="Menu" width="100%" src=""
            style="position: absolute; width: 0; height: 0; border: 0; border: none; position: absolute; overflow-y: hidden; background-color: silver;"></iframe>
          <div id="frame-container">
            <div id="loading" style="
            position: absolute;
            display: none;
            margin-bottom: auto; 
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);"  >
              <img style="height: 50px;" src="public/loading4.gif"/>
            </div>  

            <div id="info-panel" class="closed" onclick="showInformation()" >
              <div class="info-container">
                <div>
                  <img id="info-flag" src="sites/secret-project-riso/imgs/palestine-flag2.gif"/>
                </div>
                <div class="info-title">
                  Palestine Online
                </div><br>

                <div class="info-body">
                  <div>This is a curated archive of websites created by Palestinians or about Palestine from the late 90s to early 2000s. The archive locates the history of the web as an important tool for Palestinian connection, expression, self determination, and resistance.</div><br>

                  <div>Created by Amad Ansari.</div><br>

                  <div>Special thanks to Sara bin Safwan, Zainab Hassoon, Todd Anderson, Saad Khan, Gufran Jadalla, and Zainab Aliyu for opportunities and guidance which have been integral for this project to flourish.</div><br>
                  <img height="120px" src="po-qr-code.png"/>
                </div>
              </div>
            </div> 
            <iframe id="frame" title="Frame" width="99.5%" src="">
            </iframe>
          </div>
        </div>
        <div id="breadcrumbs" class="status-bar">
        </div>
      </div>
    </div>
    </div>
    <script>
      const queryString = window.location.search;
      const params = new URLSearchParams(queryString);

      let mode = params.get('mode');
      let site = params.get('site');

      initDocumentSetup(document);
      if (mode === 'presenter') presenterModeSetup(document);
      
      shareSite = shareCurrentSite;

      const iframe = document.getElementById('frame');

      // Detects when iframe finishes loading new content

      window.addEventListener('popstate', (event) => {
        const iframe = document.getElementById('frame');

        const currentUrl = new URL(window.location.href);
        console.log('CURR URL', currentUrl.href);
        // Get the current URL after navigation
        let params = new URLSearchParams(window.location.search);
        let site = params.get('site');
        console.log('🌎', site);

        const siteSrc = pagesTour.find((page) => page.id === site);

        document.getElementById(
          'current-site'
        ).innerHTML = `${siteSrc.title} <i>${siteSrc.year}</i>`;

        document.getElementById(
          'address-bar-text'
        ).innerHTML = `${siteSrc.title} <i>${siteSrc.year}</i>`;
      });

    </script>
  </body>
</html>
