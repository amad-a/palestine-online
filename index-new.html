<!DOCTYPE html>
<html>
  <head>
    <title>Palestine Online</title>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="public/98.css" />
    <link rel="stylesheet" href="public/style.css" />
    <script src="src/functions.js"></script>
  </head>

  <body onload="setFramePage()">
    <div class="mobile-buttons-grid" id="mobile-nav">
            <button id="zoomSlider">
        <div class="field-row">
          <label class="slider-label" for="range26">-</label>
          <input step="any" onchange="changeZoom(this.value)" id="range26" type="range" min="1" max="21" value="11" />
          <label class="slider-label"  for="range27">+</label>
        </div>
      </button>
      <button>
        <img height="16px" src="public/home.svg"/>
        Home
      </button>
      <button>
        <img height="16px" src="public/directory_closed_cool-4.svg"/>
        Sites
      </button>
      <button>
        <img height="16px" src="public/icons/help_book_small-5.svg"/>
        Random
      </button>
      <button>
        Menu
      </button>
    </div>
    <div class="window-grid" id="window">
      <div
        class="info-panel-container"
        id="info-panel-container"
        style="visibility: hidden"
      >
        <div class="notes-header">Page Information</div>
        <div class="close-info-panel-button">
          <div class="title-bar-controls">
            <button
              class="notes-close-button"
              style="zoom: 1.4"
              aria-label="Close"
            ></button>
          </div>
        </div>
      </div>
      <div class="window walkthru-window">
        <div class="title-bar">
          <div class="title-bar-text">
            Palestine Online
          </div>
          <div class="title-bar-controls">
            <button aria-label="Minimize"></button>
            <button aria-label="Maximize"></button>
            <button aria-label="Close"></button>
          </div>
        </div>
        <div class="window-body" style="margin: 0px; overflow: hidden;">

          <section
            style="margin: 6px 8px 4px 8px"
            class="field-row"
            style="justify-content: flex-start"
          >
          <a class="tooltip">
            <input
            type="image"
            onclick="window.history.back()"
            src="public/back.svg"
            height="24px"
            style="margin-bottom: 4px"
          />
          <span class="tooltiptext">Go Back</span>

          </a>

          <a class="tooltip">
            <input
              type="image"
              onclick="window.history.forward()"
              src="public/front.svg"
              height="24px"
              style="margin-bottom: 4px"
            />
            <span class="tooltiptext">Go Forward</span>

          </a>


            <div class="divider">|</div>
            <a>
              <input
                id="toggleMenu"
                style="opacity: 1; cursor: auto"
                onclick="toggleMenu()"
                type="image"
                src="public/directory_closed_cool-4.svg"
                height="25px"
              />
            </a>
            <a>
              <input
                style="opacity: 0.25; cursor: auto"
                type="image"
                src="public/home.svg"
                height="25px"
              />
            </a>
            <a class="tooltip">
              <input
                style="opacity: 0.25; cursor: auto"
                type="image"
                src="public/netmeeting-1.svg"
                height="25px"
              />
            </a>
            <a class="tooltip">
              <input
                style="opacity: 0.25; cursor: auto"
                type="image"
                src="public/icons/info.svg"
                height="25px"
              />
            </a>
            <a class="tooltip" target="_blank">
              <input
                style="opacity: 0.25; cursor: auto"
                type="image"
                src="public/icons/search_web-1.svg"
                height="25px"
              />
            </a>
            <a class="tooltip">
              <input
                type="image"
                src="public/icons/help_book_small-5.svg"
                height="25px"
                onclick="goToRandomPage()"
              />
              <span class="tooltiptext">Go to random site</span>
            </a>
            <a class="tooltip">
              <input
                type="image"
                onclick="setWallpaper()"
                src="public/frame_web-1.svg"
                height="25px"
              />
              <span class="tooltiptext">Change wallpaper</span>
            </a>
            <div class="goto">
              
            </div>
            <div class="dropdown-container">
              <pre id="current-site">
              </pre>
              <a class="tooltip">
                <div class="dropdown">
                </div>
                <span class="tooltiptext urltooltip">View websites</span>
              </a>
              <div class="dropdown-content">
                <ul class="tree-view" id="tree"></ul>
              </div>
              
            </div>

          </section>
          <iframe
          id="menu"
          title="Menu"
          width="100%"
          src="main-new.html"
          style = "position: absolute; width: 0; height: 0; border: 0; border: none; position: absolute; overflow-y: hidden; background-color: silver;"
        ></iframe>
          <div id="frame-container">
            <iframe
            id="frame"
            title="Frame"
            width="99.25%"
            src=""
            onLoad="console.log('hey ' + this.contentWindow.location.href);"
          >
          </iframe>
          </div>

          </div>
      

        <div id="breadcrumbs" class="status-bar">

        </div>
        
        </div>
        
      </div>
    </div>
    <script>

      // Add click event listener to the body
      document.body.addEventListener('click', function (event) {
        setWallpaper();
      });

      let sliderButton = document.getElementById("zoomSlider");
      sliderButton.disabled = true;
      

      // Add click event listener to the child element
      document.querySelector('.window-grid').addEventListener('click', function (event) {
        event.stopPropagation(); // Prevents the event from reaching the body
      });

      document.querySelector('.dropdown').addEventListener('click', function () {
        const dropdownContent = document.querySelector('.dropdown-content');
        dropdownContent.classList.toggle('open');
      });

      function toggleMenu() {
        let buttonSrc = document.getElementById('toggleMenu').src;
        if (buttonSrc.endsWith('directory_closed_cool-4.svg')) {
          document.getElementById('toggleMenu').src = buttonSrc.replace('directory_closed_cool-4.svg', 'directory_open_cool-4.svg');

          document.getElementById('menu').style = "position: absolute; width: 400px;"
        } else {
          document.getElementById('toggleMenu').src = buttonSrc.replace('directory_open_cool-4.svg', 'directory_closed_cool-4.svg');

          document.getElementById('menu').style = "width: 0; height: 0; border: 0; border: none; position: absolute;";

          document.getElementById('frame').style = ""
        }
      }

      const treeViewContainer = document.getElementById('tree');

;


// Create the tree view from the data object and append it to the container
treeViewContainer.appendChild(createTreeView(datad));

function changeZoom(value) {

  let scale = value/10;
  document.getElementById('frame').contentWindow.document.body.style.transform = `scale(${scale})`;

  document.getElementById('frame').contentWindow.document.body.style.width = `${100 / scale}%`;

  document.getElementById('frame').contentWindow.document.body.style.height = `${100 / scale}%`;

  document.getElementById('frame').contentWindow.document.body.style.transformOrigin = `0 0`;

  console.log('ZOOOM',  document.getElementById('frame').style.zoom);
}

function attachTouchEventListenersToIframe() {
      const iframe = document.getElementById('frame');

      iframe.addEventListener('load', function() {
        const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;

        // Ensure iframeDocument is available
        if (iframeDocument) {
          // Add touch event listeners to the iframe's document
          iframeDocument.addEventListener('touchstart', function(event) {
            console.log('Touch start detected in iframe');
          });

          iframeDocument.addEventListener('touchend', function(event) {
            console.log('Touch end detected in iframe');
          });

          // Optionally handle other touch events
          iframeDocument.addEventListener('touchmove', function(event) {
            console.log('Touch move detected in iframe', iframe.contentWindow.scrollY, iframe.contentWindow.scrollX)
          });

          window.addEventListener('resize', function(event) {
            console.log('Resize detected in iframe', iframe.contentWindow.scrollY, iframe.contentWindow.scrollX)
          });


        } else {
          console.log('Unable to access iframe document');
        }
      });
    }

    // Call the function to attach touch event listeners
    attachTouchEventListenersToIframe();
    </script>
  </body>
</html>
